rm int/* -f
rm bin/* -f
rm iso/* -f
x86_64-w64-mingw32-gcc -I/usr/include/efi -I/usr/include/efi/x86_64 -I/usr/include/efi/protocol -ffreestanding -fno-stack-protector -fno-merge-constants -fno-strict-aliasing -fshort-wchar -fpic -mno-red-zone -Wno-pointer-sign -Wall -DEFI_APP -DBOOT_LOADER -DCONFIG_x86_64 -DEFI_FUNCTION_WRAPPER -c -o int/main.o src/main.c
x86_64-w64-mingw32-gcc -I/usr/include/efi -I/usr/include/efi/x86_64 -I/usr/include/efi/protocol -ffreestanding -fno-stack-protector -fno-merge-constants -fno-strict-aliasing -fshort-wchar -fpic -mno-red-zone -Wno-pointer-sign -Wall -DEFI_APP -DBOOT_LOADER -DCONFIG_x86_64 -DEFI_FUNCTION_WRAPPER -c -o int/data.o src/lib.c
#x86_64-w64-mingw32-ld -nostdlib -shared -Bsymbolic --subsystem=10 -e efi_main -o bin/main.so int/main.o int/data.o
#objcopy -j .text -j .sdata -j .data -j .dynamic -j .dynsym -j .rel.* -j .rela.* -j .reloc --target=efi-app-x86_64 --subsystem=10 bin/main.so bin/main.efi
x86_64-w64-mingw32-gcc -v -Wl,-v -nostdlib -Wl,-dll -shared -Wl,--subsystem,10 -e efi_main -o bin/BOOTX64.EFI int/main.o int/data.o
GNU ld (GNU Binutils) 2.38
# create gpt image
dd if=/dev/zero of=bin/boot.img bs=1k count=1440
mformat -i bin/boot.img -f 1440 ::
mmd -i bin/boot.img ::/EFI
mmd -i bin/boot.img ::/EFI/BOOT
mcopy -i bin/boot.img bin/main.efi ::/EFI/BOOT
